var g=Object.defineProperty;var l=(i,a)=>g(i,"name",{value:a,configurable:true});import{c as G}from"./createLazyWrapper-CcCD0Sct.js";import{j as C}from"./jsx-runtime-CGXnEs--.js";import{r}from"./index-Dko9tpwX.js";import{r as J}from"./index-wC6Z_Uz1.js";import{a as Q,b as X}from"./Select-D9JGB5u8.js";import"./_commonjsHelpers-DRKe4gOT.js";import"./index-hB-uq45w.js";import"./iframe-HtAnAIQl.js";import"../sb-preview/runtime.js";import"./createIsland-D0Kq_01P.js";import"./Label-X7jo9b-B.js";import"./bem-DSWMYwqE.js";function Y(i){return Array.isArray(i)}l(Y,"isMulti");const Z=l(i=>i.replace(/-([a-z])/g,(a,f)=>f.toUpperCase()),"toDatasetKey");function ee(i,a,f=false){return f?(()=>{const m=new Set(Y(i)?i:[]);m.has(a)?m.delete(a):m.add(a);return[...m]})():a}l(ee,"mergeValue");function R({id:i,multiple:a,disabled:f,required:m,value:D,items:p,onChange:A,...I}){const v=r.useRef(null);const b=r.useRef(null);const[u,L]=r.useState(false);const[x,s]=r.useState(-1);const[h,M]=r.useState(D??(Boolean(a)?[]:""));const[$,z]=r.useState({});const[N,q]=r.useState(false);const y=!Boolean(m)&&!Boolean(a);const c=(y?1:0)+p.length;r.useEffect(()=>{M(D??(Boolean(a)?[]:""))},[D,a]);const V=r.useCallback(e=>{if(c<=0)return-1;if(e<0)return c-1;if(e>=c)return 0;return e},[c]);const T=r.useCallback(e=>{var n,o;if(y){if(e===0)return null;return(n=p[e-1])==null?void 0:n.value}return(o=p[e])==null?void 0:o.value},[y,p]);const w=r.useCallback(()=>{if(!Boolean(a)){const e=String(h??"");if(y&&e==="")return 0;const n=p.findIndex(o=>String(o.value)===e);if(n>=0)return n+(y?1:0)}else{const e=Array.isArray(h)?h:[];const n=p.findIndex(o=>e.includes(o.value));if(n>=0)return n+(y?1:0)}return c>0?0:-1},[h,a,y,p,c]);const S=r.useCallback(()=>{var e;L(false);q(false);(e=v==null?void 0:v.current)==null?void 0:e.focus()},[]);const k=r.useCallback(()=>{const e=v.current;if(!e)return false;const n=e.getBoundingClientRect();z({position:"fixed",left:n.left,top:n.bottom,width:n.width,zIndex:2147483647});return true},[]);r.useEffect(()=>{if(!u||!N)return;s(w());requestAnimationFrame(()=>{var e;(e=b.current)==null?void 0:e.focus()})},[u,N,w]);const E=r.useCallback(()=>{if(Boolean(f))return;const e=k();if(e)q(true);L(true)},[f,k]);const W=r.useCallback(()=>{L(e=>{if(e){q(false);return false}E();return true})},[E]);r.useEffect(()=>{if(!u)return;k();q(true);const e=l(()=>k(),"onResize");const n=l(()=>k(),"onScroll");window.addEventListener("resize",e);window.addEventListener("scroll",n,true);return()=>{window.removeEventListener("resize",e);window.removeEventListener("scroll",n,true)}},[u,k]);r.useEffect(()=>{if(!u)return;const e=l(n=>{var o,t;if(!Boolean((o=b.current)==null?void 0:o.contains(n.target))&&!Boolean((t=v.current)==null?void 0:t.contains(n.target))){S()}},"handleOutside");window.addEventListener("click",e);return()=>window.removeEventListener("click",e)},[u,S]);const H=l(e=>{var n,o;if(Boolean(f))return;if(e.key==="Escape"){e.preventDefault();S();return}if(e.key==="ArrowDown"){e.preventDefault();if(!u){E();return}s(t=>V((t<0?w():t)+1));(n=b.current)==null?void 0:n.focus();return}if(e.key==="ArrowUp"){e.preventDefault();if(!u){E();return}s(t=>V((t<0?w():t)-1));(o=b.current)==null?void 0:o.focus()}},"handleKey");const U=r.useMemo(()=>{const e={};for(const[n,o]of Object.entries(I)){if(n.startsWith("data-"))e[Z(n.slice(5))]=o}return e},[I]);const P=l(e=>{const n=e===null?Boolean(a)?[]:"":ee(h,e,a);const o={target:{dataset:U}};M(n);A==null?void 0:A(o,n);if(!Boolean(a))S()},"clickOption");const j=l((e,n)=>{if(e.key==="Enter"||e.key===" "){e.preventDefault();P(n)}},"onOptionKeyDown");return C.jsx(Q,{...I,disabled:f,id:i,items:p,multiple:a,required:m,value:h,_clientState:{open:u,buttonRef:v,listRef:b,onButtonClick:W,onButtonKey:H,onOptionClick:P,renderListbox:l(e=>{if(!e.open)return null;if(!N)return null;if(typeof document==="undefined")return null;const n=l(t=>{if(t.key==="Escape"){t.preventDefault();S();return}if(t.key==="ArrowDown"){t.preventDefault();s(d=>V((d<0?w():d)+1));return}if(t.key==="ArrowUp"){t.preventDefault();s(d=>V((d<0?w():d)-1));return}if(t.key==="Home"){t.preventDefault();s(c>0?0:-1);return}if(t.key==="End"){t.preventDefault();s(c>0?c-1:-1);return}if(t.key==="Enter"||t.key===" "){t.preventDefault();const d=T(x);P(d)}},"onListKeyDown");const o=C.jsxs("ul",{ref:b,"aria-multiselectable":Boolean(e.multiple)||void 0,className:e.className,id:e.id,role:"listbox",style:$,tabIndex:0,"aria-activedescendant":x>=0?`${e.id}-opt-${x}`:void 0,onKeyDown:n,children:[!Boolean(e.required)&&!Boolean(e.multiple)&&C.jsx("li",{id:`${e.id}-opt-0`,role:"option",tabIndex:-1,"aria-selected":Array.isArray(e.value)?e.value.length===0:String(e.value??"")==="",className:e.bemItem({selected:Array.isArray(e.value)?e.value.length===0:String(e.value??"")==="",active:x===0}),onClick:l(()=>e.onOptionClick(null),"onClick"),onKeyDown:l(t=>j(t,null),"onKeyDown"),onMouseMove:l(()=>s(0),"onMouseMove"),children:e.placeholder},"placeholder"),e.items.map(t=>{var K;const d=!Boolean(e.required)&&!Boolean(e.multiple);const F=e.items.findIndex(O=>O.value===t.value);const _=F+(d?1:0);const B=Array.isArray(e.value)?e.value.includes(t.value):t.value===e.value;return C.jsxs("li",{"aria-selected":B,id:`${e.id}-opt-${_}`,role:"option",tabIndex:-1,className:e.bemItem({selected:B,active:x===_}),onClick:l(()=>e.onOptionClick(t.value),"onClick"),onKeyDown:l(O=>j(O,t.value),"onKeyDown"),onMouseMove:l(()=>s(_),"onMouseMove"),children:[Boolean(e.multiple)&&C.jsx("input",{readOnly:true,"aria-hidden":"true",className:e.bemCheckbox({checked:B}),defaultChecked:B,type:"checkbox"}),Boolean(e.iconVisible)&&((K=t.icon)==null?void 0:K.call(t)),t.label]},`${e.id}-${t.value}`)})]});return J.createPortal(o,document.body)},"renderListbox")}})}l(R,"SelectClient");const te=r.memo(R);try{R.displayName="SelectClient";R.__docgenInfo={"description":"","displayName":"SelectClient","props":{"id":{"defaultValue":null,"description":"Unique identifier (used for label association).","name":"id","required":true,"type":{"name":"string"}},"name":{"defaultValue":null,"description":"Form field name attribute.","name":"name","required":false,"type":{"name":"string"}},"items":{"defaultValue":null,"description":"List of selectable options.","name":"items","required":true,"type":{"name":"SelectItem<Value>[]"}},"fullWidth":{"defaultValue":null,"description":"Stretch to full width of parent.","name":"fullWidth","required":false,"type":{"name":"boolean"}},"multiple":{"defaultValue":null,"description":"Allow multiple selections (returns array).","name":"multiple","required":false,"type":{"name":"boolean"}},"disabled":{"defaultValue":null,"description":"Disable interaction.","name":"disabled","required":false,"type":{"name":"boolean"}},"required":{"defaultValue":null,"description":"Mark as required (shows asterisk in label).","name":"required","required":false,"type":{"name":"boolean"}},"value":{"defaultValue":null,"description":"Current selected value(s). Controlled prop.","name":"value","required":false,"type":{"name":"string | Value[] | null"}},"placeholder":{"defaultValue":null,"description":"Placeholder text when no value selected.","name":"placeholder","required":false,"type":{"name":"string"}},"onChange":{"defaultValue":null,"description":"Called when selection changes.","name":"onChange","required":false,"type":{"name":"((e: SelectEvent, v: SelectValue<string>) => void)"}},"label":{"defaultValue":null,"description":"Label text shown above dropdown.","name":"label","required":true,"type":{"name":"string"}},"hideLabel":{"defaultValue":null,"description":"Hide label (but keep in DOM for a11y).","name":"hideLabel","required":false,"type":{"name":"boolean"}},"iconVisible":{"defaultValue":null,"description":"Show icon inside selected option button.","name":"iconVisible","required":false,"type":{"name":"boolean"}},"helperText":{"defaultValue":null,"description":"Helper text shown below dropdown.","name":"helperText","required":false,"type":{"name":"string"}},"errorText":{"defaultValue":null,"description":"Error message shown in red.","name":"errorText","required":false,"type":{"name":"string"}},"className":{"defaultValue":null,"description":"CSS class on root container.","name":"className","required":false,"type":{"name":"string"}},"fieldClassName":{"defaultValue":null,"description":"CSS class on field wrapper.","name":"fieldClassName","required":false,"type":{"name":"string"}},"selectClassName":{"defaultValue":null,"description":"CSS class on select button.","name":"selectClassName","required":false,"type":{"name":"string"}},"labelProps":{"defaultValue":null,"description":"Props forwarded to Label component.","name":"labelProps","required":false,"type":{"name":"LabelProps"}},"ref":{"defaultValue":null,"description":"Ref to underlying select element.","name":"ref","required":false,"type":{"name":"Ref<HTMLSelectElement>"}}}}}catch(i){}const ye=G({name:"Select",Client:te,Server:X,isInteractive:l(()=>true,"isInteractive")});export{ye as default};
