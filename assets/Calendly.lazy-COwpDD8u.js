var q=Object.defineProperty;var p=(m,o)=>q(m,"name",{value:o,configurable:true});import{c as R}from"./createLazyWrapper-AC75M60Y.js";import{j as d}from"./jsx-runtime-CGXnEs--.js";import{r as n}from"./index-DGnhqvo7.js";import{a as l}from"./validations-DJC0TP_C.js";import{L as A}from"./Loading-DZFdw8ve.js";import{A as F}from"./Animated-D73MH9pY.js";import{C as z}from"./Calendly.stories-DtS3pHST.js";import"./_commonjsHelpers-DRKe4gOT.js";import"./iframe-BTrXp-vY.js";import"../sb-preview/runtime.js";import"./createIsland-fzL0F2Ul.js";import"./bem-DSWMYwqE.js";let y=false;let T=false;function P(m){const{calendlyId:o,data:t,colors:a={text:"#4D4D4D",button:"#1E90FF",background:"#FFFFFF"},animationProps:D,hideLoading:I,hideCookieSettings:x,hideEventTypeDetails:k,hideDetails:L,...j}=m;const h=n.useRef(null);const w=n.useRef(false);const g=n.useRef(false);const[r,C]=n.useState(false);const[u,E]=n.useState(y);const[_,f]=n.useState(null);const b=p(e=>e==null?void 0:e.replaceAll("#",""),"format");const S=n.useCallback(()=>{const e={};if(!t)return e;for(const i of["name","email","firstName","lastName"]){if(l(t[i]))e[i]=t[i]}return e},[t]);const c=n.useMemo(()=>{const e=new URLSearchParams;if(Boolean(L))e.set("hide_landing_page_details","1");if(Boolean(k))e.set("hide_event_type_details","1");if(Boolean(x))e.set("hide_gdpr_banner","1");if(l(a.background))e.set("background_color",b(a==null?void 0:a.background));if(l(a.text))e.set("text_color",b(a.text));if(l(a.button))e.set("primary_color",b(a.button));if(l(t==null?void 0:t.utm_campaign))e.set("utm_campaign",(t==null?void 0:t.utm_campaign)??"");if(l(t==null?void 0:t.utm_source))e.set("utm_source",(t==null?void 0:t.utm_source)??"");return o?`https://calendly.com/${o}?${e.toString()}`:""},[o,a,t,L,k,x]);const s=n.useCallback((e=0)=>{const i=h.current;if(!i)return;if(g.current)return;if(i.dataset.initialized==="1")return;if(r)return;if(!o){f("Calendly ID missing.");return}if(!c){f("Calendly URL could not be built.");return}if(window.Calendly){try{i.innerHTML=""}catch{}i.setAttribute("data-url",c);window.Calendly.initInlineWidget({url:c,parentElement:i,prefill:S()});C(true);g.current=true;i.dataset.initialized="1";C(true);return}if(e<10){setTimeout(()=>s(e+1),100)}else{console.warn("Calendly widget failed to load.");f("Calendly widget failed to load.")}},[c,S,r,o]);const v=n.useCallback(e=>{w.current=e;if(!e||r)return;if(u)s()},[u,r,s]);n.useEffect(()=>()=>{const e=h.current;if(e){try{e.innerHTML="";delete e.dataset.initialized}catch{}}g.current=false;C(false)},[]);n.useEffect(()=>{if(y||typeof document==="undefined"){E(true);return}const e=document.createElement("script");e.src="https://assets.calendly.com/assets/external/widget.js";e.async=true;e.onload=()=>{y=true;E(true)};e.onerror=()=>{f("Calendly script blocked or failed to load.")};document.body.appendChild(e);const i=window.setTimeout(()=>{if(!y)f("Calendly script did not load (timeout).")},8e3);return()=>clearTimeout(i)},[]);n.useEffect(()=>{if(T||typeof document==="undefined")return;const e=document.createElement("link");e.rel="stylesheet";e.href="https://assets.calendly.com/assets/external/widget.css";document.head.appendChild(e);T=true},[]);n.useEffect(()=>{if(u&&w.current&&!r){s()}},[u,r,s]);n.useEffect(()=>{if(u&&!r){const e=setTimeout(()=>s(),0);return()=>clearTimeout(e)}return},[u,r,s]);const V={display:"block",minWidth:320,height:700};return d.jsxs(F,{...D,onAnimate:v,children:[!Boolean(I)&&!Boolean(r)&&!l(_)&&d.jsx(A,{}),l(_)&&d.jsxs("div",{role:"alert",style:{padding:12},children:[d.jsx("p",{style:{margin:0},children:_}),c&&d.jsx("p",{style:{marginTop:8},children:d.jsx("a",{href:c,rel:"noreferrer",target:"_blank",children:"Open Calendly in a new tab"})})]}),d.jsx("div",{ref:h,...j,style:V})]})}p(P,"CalendlyClient");try{Calendlyclient.displayName="Calendlyclient";Calendlyclient.__docgenInfo={"description":"","displayName":"Calendlyclient","props":{"calendlyId":{"defaultValue":null,"description":"","name":"calendlyId","required":true,"type":{"name":"string"}},"data":{"defaultValue":null,"description":"","name":"data","required":false,"type":{"name":"CalendlyData"}},"animationProps":{"defaultValue":null,"description":"","name":"animationProps","required":false,"type":{"name":"AnimatedProps"}},"colors":{"defaultValue":null,"description":"","name":"colors","required":false,"type":{"name":"CalendlyColorOptions"}},"hideLoading":{"defaultValue":null,"description":"","name":"hideLoading","required":false,"type":{"name":"boolean"}},"hideCookieSettings":{"defaultValue":null,"description":"","name":"hideCookieSettings","required":false,"type":{"name":"boolean"}},"hideEventTypeDetails":{"defaultValue":null,"description":"","name":"hideEventTypeDetails","required":false,"type":{"name":"boolean"}},"hideDetails":{"defaultValue":null,"description":"","name":"hideDetails","required":false,"type":{"name":"boolean"}},"LoadingComponent":{"defaultValue":null,"description":"","name":"LoadingComponent","required":false,"type":{"name":"ComponentType<{}>"}}}}}catch(m){}const Y=R({name:"Calendly",Client:P,Server:z,hydrateOnVisible:true,isInteractive:p(()=>true,"isInteractive")});export{Y as default};
